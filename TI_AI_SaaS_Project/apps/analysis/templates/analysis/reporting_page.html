{# AI Analysis Reporting Page #}
{% extends 'accounts/base.html' %}
{% load static %}

{% block title %}AI Analysis Report - {{ job_listing.title }}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/analysis.css' %}">
{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Report Header -->
    <div class="flex justify-between items-start mb-6 pb-6 border-b-2 border-secondary-text">
        <div>
            <h1 class="text-3xl font-bold text-primary-text mb-2">AI Analysis Report</h1>
            <h2 class="text-lg text-secondary-text mb-2">{{ job_listing.title }}</h2>
            <p class="text-sm text-secondary-text">Generated: {{ generated_at|date:"M d, Y H:i" }}</p>
        </div>

        <div class="flex gap-3">
            <a href="{% url 'jobs:job_detail' job_listing.id %}" class="bg-code-block-bg text-primary-text px-5 py-2.5 rounded text-sm font-medium hover:bg-gray-300 transition">
                ‚Üê Back to Job
            </a>
            <button onclick="window.print()" class="bg-accent-cta text-cta-text px-5 py-2.5 rounded text-sm font-medium hover:brightness-110 transition">
                üìÑ Print Report
            </button>
        </div>
    </div>

    {# AI Disclaimer #}
    {% include 'analysis/_ai_disclaimer.html' %}

    {# Statistics Overview #}
    {% include 'analysis/_statistics_panel.html' with statistics=statistics %}

    {# Comparison View Toggle #}
    <div class="text-right mb-4">
        <button id="toggle-view-btn" class="bg-code-block-bg text-primary-text font-semibold px-5 py-2.5 rounded hover:bg-gray-300 transition" type="button">
            Switch to Comparison View
        </button>
    </div>

    {# Table View (Default) #}
    <div id="table-view">
        {% include 'analysis/results_list.html' with results=results page_obj=page_obj %}
    </div>

    {# Comparison View #}
    <div id="comparison-view" style="display: none;">
        {% include 'analysis/_comparison_view.html' with results=results %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/analysis.js' %}"></script>
{% endblock %}
